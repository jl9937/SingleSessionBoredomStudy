<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Backend</title>
    <style>
        body {background-color: #FFFFFF; }
    </style>
</head>
<body onload="init()">
<h2>Database access to Mindgames MKII</h2>
       
<p>Click on a button below to run that script on the database:</p>


<br/><button id="activityButton">Download Activity</button>
<br /><button id="participantsButton">Download Participants</button>
<br /><button id="questionnairesButton">Download Questionnaires</button>
<br/><button id="sessionsButton">Download Sessions</button>
<br/><button id="trialsButton">Download Trials</button>


<div id="updates"><ul></ul></div>
    
<br/><button id="logoutButton">Logout</button>

<script src="https://www.gstatic.com/firebasejs/3.2.0/firebase.js"></script>
<script src="js/libs/jquery-3.2.0.min.js"></script>
<script src="js/libs/FileSaver.js"></script>
<script src="js/Main.js"></script>
<script src="js/helpers/backendDownloading.js"></script>


<script>
    $ = $;

    var initialised = null;
    function init()
    {
        if (initialised === null)
        {
            var config = {
                apiKey: "AIzaSyACCRI2t52ESEl-CkFiKGY6dWSpzysJ_js",
                authDomain: Main.URL,
                databaseURL: Main.DBURL,
                projectId: "mindgamesmkii",
                storageBucket: "mindgamesmkii.appspot.com",
                messagingSenderId: "275495539195"
            };
            initialised = firebase.initializeApp(config);
        }
        

        firebase.auth().onAuthStateChanged(function (user) {
            if (!user)
            {
                window.location = '/login.html';
            }
            else
            {
                output("Login correct");
                output("Connected to: " + Main.DBURL);
            }
        });
        var ref = firebase.database().ref();

        $("#activityButton").click(getActivity.bind(this, ref));
        $("#participantsButton").click(getParticipants.bind(this, ref));        
        $("#questionnairesButton").click(getQuestionnaires.bind(this, ref));
        $("#sessionsButton").click(getSessions.bind(this, ref));
        $("#trialsButton").click(getTrials.bind(this, ref));
        $("#logoutButton").click(logout.bind(this));
    };

    
</script>



</body>
</html>